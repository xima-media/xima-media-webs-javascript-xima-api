var XIMA={api:{}};window.initOverlappingMarkerSpiderfier=function(){var f=!0,d=null,m=!1;(function(){var e,l={}.hasOwnProperty,s=[].slice;((e=this.google)!=d?e.maps:void 0)!=d&&(this.OverlappingMarkerSpiderfier=function(){function e(e,t){var r,i,n,o,s=this;for(r in this.map=e,t==d&&(t={}),t)l.call(t,r)&&(i=t[r],this[r]=i);for(this.e=new this.constructor.g(this.map),this.n(),this.b={},i=0,n=(o=["click","zoom_changed","maptypeid_changed"]).length;i<n;i++)r=o[i],g.addListener(this.map,r,function(){return s.unspiderfy()})}var g,c,t,r,i,n,a,o;for(r=0,i=(o=[e,n=e.prototype]).length;r<i;r++)(t=o[r]).VERSION="0.3.3";return c=google.maps,g=c.event,i=c.MapTypeId,a=2*Math.PI,n.keepSpiderfied=m,n.markersWontHide=m,n.markersWontMove=m,n.nearbyDistance=20,n.circleSpiralSwitchover=9,n.circleFootSeparation=23,n.circleStartAngle=a/12,n.spiralFootSeparation=26,n.spiralLengthStart=11,n.spiralLengthFactor=4,n.spiderfiedZIndex=1e3,n.usualLegZIndex=10,n.highlightedLegZIndex=20,n.legWeight=1.5,n.legColors={usual:{},highlighted:{}},r=n.legColors.usual,t=n.legColors.highlighted,r[i.HYBRID]=r[i.SATELLITE]="#fff",t[i.HYBRID]=t[i.SATELLITE]="#f00",r[i.TERRAIN]=r[i.ROADMAP]="#444",t[i.TERRAIN]=t[i.ROADMAP]="#f00",n.n=function(){this.a=[],this.j=[]},n.addMarker=function(t){var e,r=this;return t._oms!=d||(t._oms=f,e=[g.addListener(t,"click",function(e){return r.F(t,e)})],this.markersWontHide||e.push(g.addListener(t,"visible_changed",function(){return r.o(t,m)})),this.markersWontMove||e.push(g.addListener(t,"position_changed",function(){return r.o(t,f)})),this.j.push(e),this.a.push(t)),this},n.o=function(e,t){if(e._omsData!=d&&(t||!e.getVisible())&&this.s==d&&this.t==d)return this.unspiderfy(t?e:d)},n.getMarkers=function(){return this.a.slice(0)},n.removeMarker=function(e){var t,r,i,n,o;if(e._omsData!=d&&this.unspiderfy(),(t=this.m(this.a,e))<0)return this;for(n=0,o=(i=this.j.splice(t,1)[0]).length;n<o;n++)r=i[n],g.removeListener(r);return delete e._oms,this.a.splice(t,1),this},n.clearMarkers=function(){var e,t,r,i,n,o,s,a;for(this.unspiderfy(),e=i=0,o=(a=this.a).length;i<o;e=++i){for(r=a[e],n=0,s=(t=this.j[e]).length;n<s;n++)e=t[n],g.removeListener(e);delete r._oms}return this.n(),this},n.addListener=function(e,t){var r,i;return((i=(r=this.b)[e])!=d?i:r[e]=[]).push(t),this},n.removeListener=function(e,t){var r;return(r=this.m(this.b[e],t))<0||this.b[e].splice(r,1),this},n.clearListeners=function(e){return this.b[e]=[],this},n.trigger=function(){var e,t,r,i,n,o;for(t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],o=[],i=0,n=(t=(r=this.b[t])!=d?r:[]).length;i<n;i++)r=t[i],o.push(r.apply(d,e));return o},n.u=function(e,t){var r,i,n,o,s;for(n=this.circleFootSeparation*(2+e)/a,i=a/e,s=[],r=o=0;0<=e?o<e:e<o;r=0<=e?++o:--o)r=this.circleStartAngle+r*i,s.push(new c.Point(t.x+n*Math.cos(r),t.y+n*Math.sin(r)));return s},n.v=function(e,t){var r,i,n,o,s;for(n=this.spiralLengthStart,s=[],i=o=r=0;0<=e?o<e:e<o;i=0<=e?++o:--o)r+=this.spiralFootSeparation/n+5e-4*i,i=new c.Point(t.x+n*Math.cos(r),t.y+n*Math.sin(r)),n+=a*this.spiralLengthFactor/r,s.push(i);return s},n.F=function(e,t){var r,i,n,o,s,a,l,p,h;if((!(o=e._omsData!=d)||!this.keepSpiderfied)&&this.unspiderfy(),o||this.map.getStreetView().getVisible()||"GoogleEarthAPI"===this.map.getMapTypeId())return this.trigger("click",e,t);for(o=[],s=[],a=(r=this.nearbyDistance)*r,n=this.c(e.position),l=0,p=(h=this.a).length;l<p;l++)(r=h[l]).map!=d&&r.getVisible()&&(i=this.c(r.position),this.f(i,n)<a?o.push({A:r,p:i}):s.push(r));return 1===o.length?this.trigger("click",e,t):this.G(o,s)},n.markersNearMarker=function(e,t){var r,i,n,o,s,a,l,p,h,u;if(t==d&&(t=m),this.e.getProjection()==d)throw"Must wait for 'idle' event on map before calling markersNearMarker";for(s=(r=this.nearbyDistance)*r,n=this.c(e.position),o=[],a=0,l=(p=this.a).length;a<l&&!((r=p[a])!==e&&r.map!=d&&r.getVisible()&&(i=this.c((h=(u=r._omsData)!=d?u.l:void 0)!=d?h:r.position),this.f(i,n)<s&&(o.push(r),t)));a++);return o},n.markersNearAnyOtherMarker=function(){var e,t,r,i,n,o,s,a,l,p,h,u;if(this.e.getProjection()==d)throw"Must wait for 'idle' event on map before calling markersNearAnyOtherMarker";for(e=(o=this.nearbyDistance)*o,o=[],h=0,r=(i=this.a).length;h<r;h++)t=i[h],o.push({q:this.c((s=(l=t._omsData)!=d?l.l:void 0)!=d?s:t.position),d:m});for(t=s=0,l=(h=this.a).length;s<l;t=++s)if((r=h[t]).map!=d&&r.getVisible()&&!(i=o[t]).d)for(r=a=0,p=(u=this.a).length;a<p;r=++a)if(n=u[r],r!==t&&n.map!=d&&n.getVisible()&&(n=o[r],(!(r<t)||n.d)&&this.f(i.q,n.q)<e)){i.d=n.d=f;break}for(r=[],e=s=0,l=(h=this.a).length;s<l;e=++s)t=h[e],o[e].d&&r.push(t);return r},n.z=function(e){var t=this;return{h:function(){return e._omsData.i.setOptions({strokeColor:t.legColors.highlighted[t.map.mapTypeId],zIndex:t.highlightedLegZIndex})},k:function(){return e._omsData.i.setOptions({strokeColor:t.legColors.usual[t.map.mapTypeId],zIndex:t.usualLegZIndex})}}},n.G=function(n,e){var t,o,s,a,l,p,h,i,u,r;return this.s=f,r=n.length,t=this.C(function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)i=n[e],r.push(i.p);return r}()),a=r>=this.circleSpiralSwitchover?this.v(r,t).reverse():this.u(r,t),t=function(){var e,t,r,i=this;for(r=[],e=0,t=a.length;e<t;e++)s=a[e],o=this.D(s),u=this.B(n,function(e){return i.f(e.p,s)}),h=u.A,p=new c.Polyline({map:this.map,path:[h.position,o],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex}),h._omsData={l:h.position,i:p},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(l=this.z(h),h._omsData.w={h:g.addListener(h,"mouseover",l.h),k:g.addListener(h,"mouseout",l.k)}),h.setPosition(o),h.setZIndex(Math.round(this.spiderfiedZIndex+s.y)),r.push(h);return r}.call(this),delete this.s,this.r=f,this.trigger("spiderfy",t,e)},n.unspiderfy=function(e){var t,r,i,n,o,s,a;if(e==d&&(e=d),this.r==d)return this;for(this.t=f,n=[],i=[],o=0,s=(a=this.a).length;o<s;o++)(r=a[o])._omsData!=d?(r._omsData.i.setMap(d),r!==e&&r.setPosition(r._omsData.l),r.setZIndex(d),(t=r._omsData.w)!=d&&(g.removeListener(t.h),g.removeListener(t.k)),delete r._omsData,n.push(r)):i.push(r);return delete this.t,delete this.r,this.trigger("unspiderfy",n,i),this},n.f=function(e,t){var r,i;return(r=e.x-t.x)*r+(i=e.y-t.y)*i},n.C=function(e){var t,r,i,n,o;for(n=r=i=0,o=e.length;n<o;n++)r+=(t=e[n]).x,i+=t.y;return e=e.length,new c.Point(r/e,i/e)},n.c=function(e){return this.e.getProjection().fromLatLngToDivPixel(e)},n.D=function(e){return this.e.getProjection().fromDivPixelToLatLng(e)},n.B=function(e,t){var r,i,n,o,s,a;for(n=s=0,a=e.length;s<a;n=++s)o=t(o=e[n]),(void 0===r||r===d||o<i)&&(i=o,r=n);return e.splice(r,1)[0]},n.m=function(e,t){var r,i,n;if(e.indexOf!=d)return e.indexOf(t);for(r=i=0,n=e.length;i<n;r=++i)if(e[r]===t)return r;return-1},(e.g=function(e){return this.setMap(e)}).prototype=new c.OverlayView,e.g.prototype.draw=function(){},e}())}).call(this)},XIMA.api.googlemaps=function(a,e,t,r){var g={},c=null,i=null,s=null,n=!1,l=[],f=[],p=[],o={},d={},h={backgroundColor:"String",center:"google.maps.LatLng",disableDefaultUI:"Boolean",disableDoubleClickZoom:"Boolean",draggable:"Boolean",draggableCursor:"String",draggingCursor:"String",heading:"Number",keyboardShortcuts:"Boolean",mapMaker:"Boolean",mapTypeControl:"Boolean",mapTypeControlOptions:"google.maps.MapTypeControlOptions",mapTypeId:"google.maps.MapTypeId",maxZoom:"Number",minZoom:"Number",noClear:"Boolean",overviewMapControl:"Boolean",overviewMapControlOptions:"google.maps.OverviewMapControlOptions",panControl:"Boolean",panControlOptions:"google.maps.PanControlOptions",rotateControl:"Boolean",rotateControlOptions:"google.maps.RotateControlOptions",scaleControl:"Boolean",scaleControlOptions:"google.maps.ScaleControlOptions",scrollwheel:"Boolean",streetView:"google.maps.StreetViewPanorama",streetViewControl:"Boolean",streetViewControlOptions:"google.maps.StreetViewControlOptions",styles:"google.maps.MapTypeStyle",tilt:"Number",zoom:"Number",zoomControl:"Boolean",zoomControlOptions:"google.maps.ZoomControlOptions"},u=null,m={keepSpiderfied:!0},y={IsNotJson:"Die angegebene Variable ist keine JSON!",MissingMapDataProperty:"Dem MapData-Object fehlen die benötigten Eigenschaften!",MissingMapCanvas:"Es wird ein Map-Canvas benötigt!",MissingMap:"Fehlende GoogleMaps Instanz!"};return g.initGoogleMaps=function(e,t){if(g.getMapOptions(),!0===n)return this;if(!i)return console.log(y.MissingMapCanvas),this;for(var r in n=!0,c=new google.maps.Map(i,g.getMapOptions()),this.applyMapData(e,t),o)o.hasOwnProperty(r)&&o[r].setMap(c);return this},g.applyMapData=function(e,t){if(!c)return console.log(y.MissingMap),this;if(jQuery.isEmptyObject(d)||!d.points)return console.log(y.MissingMapDataProperty),this;t="boolean"!=typeof t||t;if(e="boolean"!=typeof e||e)var r=new google.maps.LatLngBounds;var i,n,o,s,a,l,p=!jQuery.isEmptyObject(d)&&d.points?Object.keys(d.points).length:0;t&&this.createOverlappingMarkerSpiderfier();for(var h=0;h<p;h++)a=parseFloat(d.points[h].lat),l=parseFloat(d.points[h].lng),isNaN(a)||isNaN(l)||(n=new google.maps.LatLng(a,l),i=d.points[h].title?d.points[h].title:"",o=d.points[h].icon?d.points[h].icon:null,this.addMarker(n,i,o),s=f.length-1,e&&r.extend(f[s].position),f[s].setMap(c));if(e&&0<f.length){c.fitBounds(r);var u=google.maps.event.addListener(c,"zoom_changed",function(){c.getZoom()>g.getMapOptions.zoom&&c.setZoom(g.getMapOptions.zoom),google.maps.event.removeListener(u)})}},g.closeInfoWindows=function(){0<l.length&&(l[0].set("marker",null),l[0].close(),l.length=0)},g.setMapOptions=function(e){return e&&g.convertDataType(e,h)&&(u=e),this},g.addMapOptions=function(e){return e&&g.convertDataType(e,h)&&jQuery.extend(g.getMapOptions,e),this},g.convertDataType=function(t,e){if(!e||"object"!=typeof t)return!1;var r=!0;for(var i in t)if(e[i]){var n,o=e[i].split(".");n=a[o[0]];for(var s=1;s<o.length;s++)n=n[o[s]];if(!(t[i]instanceof n||typeof t[i]===n)&&typeof t[i]!==n)try{t[i]=n(t[i])}catch(e){try{t[i]=new n}catch(e){console.log("Cannot convert "+t[i]+" to "+n),r=!1}}}return r},g.getMapOptions=function(){return typeof u!=google.maps&&(u={center:new google.maps.LatLng(51.06966,13.778158),zoom:8}),u},g.setMapData=function(t){if("array"===jQuery.type(t)||"object"===jQuery.type(t))d=t;else if("string"===jQuery.type(t))for(var e=!0;e;){try{d=jQuery.parseJSON(json)}catch(e){if(0!==jQuery(t).length){json=jQuery(t).val();continue}console.log(y.IsNotJson)}e=!1}return jQuery.isEmptyObject(d)||!d.points?console.log(y.MissingMapDataProperty):d.mapOptions&&this.addMapOptions(d.mapOptions),this},g.setMapCanvas=function(e){return i=jQuery(e).get(0),this},g.addLayers=function(e){if("object"==typeof e)for(var t in e)o[t]=new google.maps.KmlLayer({url:e[t],preserveViewport:!0});return this},g.removeLayer=function(e){return e&&o.key&&delete o.key,this},g.addMarker=function(e,t,r,i){if(!c)return console.log(y.MissingMap),this;var n,o=this;if(f.push(new google.maps.Marker({position:e,title:t,icon:r,map:c})),j=f.length-1,s&&s.addMarker(f[j]),!1!==i){i=i||d.points[j].windowContent;google.maps.event.addListener(f[j],"click",(n=j,function(){o.closeInfoWindows();var e=new google.maps.InfoWindow({content:i});e.open(c,f[n]),l[0]=e}))}return this},g.setAllMarkersMap=function(e){for(var t=f.length-1;0<=t;t--)f[t].setMap(e);return this},g.clearMarkers=function(){return this.setAllMarkersMap(null),this},g.deleteMarkers=function(){return this.clearMarkers(),f=[],this},g.showMarkers=function(){return c&&this.setAllMarkersMap(c),this},g.createOverlappingMarkerSpiderfier=function(){return a.initOverlappingMarkerSpiderfier(),c&&(s=new OverlappingMarkerSpiderfier(c,m)),this},g.getOMSOptions=function(){return m},g.drawPolyline=function(e,t,r){var i=[];t&&(d.routes[e]=jQuery.parseJSON(t));for(var n=jQuery.isEmptyObject(d)||jQuery.isEmptyObject(d.routes)||!d.routes[e]?0:Object.keys(d.routes[e]).length,o=0;o<n;o++)d.routes[e][o].lat&&d.routes[e][o].lng&&i.push(new google.maps.LatLng(parseFloat(d.routes[e][o].lat),parseFloat(d.routes[e][o].lng)));var s={path:i,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2};return r&&jQuery.extend(s,r),p[e]=new google.maps.Polyline(s),c&&p[e].setMap(c),this},g}(window,document,jQuery),XIMA.api.openlayers=function(e,t,s,r){var a={},l=[],p=function(r){var i=this;this.map=new ol.Map({target:r.target}),this.addLayer=function(e){i.map.addLayer(e)},this.initialize=function(){if(r.hasOwnProperty("baseLayerUrl")){var e=new ol.layer.Tile({source:new ol.source.XYZ({attributions:[new ol.Attribution({html:r.attribution||""})],tilePixelRatio:2,url:r.baseLayerUrl}),name:"baseLayer",title:"Base Layer"});i.map.addLayer(e)}if(r.hasOwnProperty("view")){jQuery.extend(r.view,{center:ol.proj.transform([r.view.lon,r.view.lat],"EPSG:4326","EPSG:3857"),zoom:r.view.zoom||7});var t=new ol.View(r.view);i.map.setView(t)}},this.initialize()};return{createMaps:function(e,t,r,i,n){var o;return o={baseLayerUrl:r,view:i,attribution:n},s((a={wrapper:e,map:t}).wrapper).each(function(){s(a.map,s(this)).each(function(){l.push(new p({target:s(this).get(0),baseLayerUrl:o.baseLayerUrl,view:o.view,attribution:o.attribution}))})}),l}}}(window,document,jQuery),XIMA.api.responsiveImages=function(e,t,s,r){var i={};function n(){s(i.wrapper).each(function(){var o={width:s(this).width()};s(i.image,s(this)).each(function(){var e=s(this),t=e.data("srcset").split(","),r=[];for(var i in t)t[i]&&r.push({src:/(?:.(?!\d+w))+/.exec(t[i])[0].trim(),width:/(\d+)(?:w)/.exec(t[i])[1]});for(var n in r.sort(function(e,t){return e.width-t.width}),r){if(r[n].width>=o.width){e.attr("src",r[n].src),e.attr("width",o.width);break}n===r.length-1&&(e.attr("src",r[n].src),e.attr("width",o.width))}})})}return e.onresize=n,{run:function(e,t){i={wrapper:e||"body",image:t||"img"},n()},refresh:function(){n()}}}(window,document,jQuery);