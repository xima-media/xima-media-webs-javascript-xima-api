var XIMA={api:{}};XIMA.api.googlemaps=function(e,t,o,n){var c=null,r=null,i=null,a=!1,s=[],h=[],l=[],p={},m={},u={backgroundColor:"String",center:"google.maps.LatLng",disableDefaultUI:"Boolean",disableDoubleClickZoom:"Boolean",draggable:"Boolean",draggableCursor:"String",draggingCursor:"String",heading:"Number",keyboardShortcuts:"Boolean",mapMaker:"Boolean",mapTypeControl:"Boolean",mapTypeControlOptions:"google.maps.MapTypeControlOptions",mapTypeId:"google.maps.MapTypeId",maxZoom:"Number",minZoom:"Number",noClear:"Boolean",overviewMapControl:"Boolean",overviewMapControlOptions:"google.maps.OverviewMapControlOptions",panControl:"Boolean",panControlOptions:"google.maps.PanControlOptions",rotateControl:"Boolean",rotateControlOptions:"google.maps.RotateControlOptions",scaleControl:"Boolean",scaleControlOptions:"google.maps.ScaleControlOptions",scrollwheel:"Boolean",streetView:"google.maps.StreetViewPanorama",streetViewControl:"Boolean",streetViewControlOptions:"google.maps.StreetViewControlOptions",styles:"google.maps.MapTypeStyle",tilt:"Number",zoom:"Number",zoomControl:"Boolean",zoomControlOptions:"google.maps.ZoomControlOptions"},f={center:new google.maps.LatLng(51.06966,13.778158),zoom:8},g={keepSpiderfied:!0},d={IsNotJson:"Die angegebene Variable ist keine JSON!",MissingMapDataProperty:"Dem MapData-Object fehlen die benötigten Eigenschaften!",MissingMapCanvas:"Es wird ein Map-Canvas benötigt!",MissingMap:"Fehlende GoogleMaps Instanz!"};this.initGoogleMaps=function(e,t){if(!0===a)return this;if(!r)return console.log(d.MissingMapCanvas),this;for(var o in a=!0,c=new google.maps.Map(r,f),this.applyMapData(e,t),p)p.hasOwnProperty(o)&&p[o].setMap(c);return this},this.applyMapData=function(e,t){if(!c)return console.log(d.MissingMap),this;if(jQuery.isEmptyObject(m)||!m.points)return console.log(d.MissingMapDataProperty),this;t="boolean"!=typeof t||t;if(e="boolean"!=typeof e||e)var o=new google.maps.LatLngBounds;var n,r,a,i,s,l,p=!jQuery.isEmptyObject(m)&&m.points?Object.keys(m.points).length:0;t&&this.createOverlappingMarkerSpiderfier();for(var u=0;u<p;u++)s=parseFloat(m.points[u].lat),l=parseFloat(m.points[u].lng),isNaN(s)||isNaN(l)||(r=new google.maps.LatLng(s,l),n=m.points[u].title?m.points[u].title:"",a=m.points[u].icon?m.points[u].icon:null,this.addMarker(r,n,a),i=h.length-1,e&&o.extend(h[i].position),h[i].setMap(c));if(e&&0<h.length){c.fitBounds(o);var g=google.maps.event.addListener(c,"zoom_changed",function(){c.getZoom()>f.zoom&&c.setZoom(f.zoom),google.maps.event.removeListener(g)})}},this.closeInfoWindows=function(){0<s.length&&(s[0].set("marker",null),s[0].close(),s.length=0)},this.setMapOptions=function(e){return e&&xima.api.functions.convertDataType(e,u)&&(f=e),this},this.addMapOptions=function(e){return e&&xima.api.functions.convertDataType(e,u)&&jQuery.extend(f,e),this},this.getMapOptions=function(){return f},this.setMapData=function(t){if("array"===jQuery.type(t)||"object"===jQuery.type(t))m=t;else if("string"===jQuery.type(t))for(var e=!0;e;){try{m=jQuery.parseJSON(json)}catch(e){if(0!==jQuery(t).length){json=jQuery(t).val();continue}console.log(d.IsNotJson)}e=!1}return jQuery.isEmptyObject(m)||!m.points?console.log(d.MissingMapDataProperty):m.mapOptions&&this.addMapOptions(m.mapOptions),this},this.setMapCanvas=function(e){return r=jQuery(e).get(0),this},this.addLayers=function(e){if("object"==typeof e)for(var t in e)p[t]=new google.maps.KmlLayer({url:e[t],preserveViewport:!0});return this},this.removeLayer=function(e){return e&&p.key&&delete p.key,this},this.addMarker=function(e,t,o,n){if(!c)return console.log(d.MissingMap),this;var r,a=this;if(h.push(new google.maps.Marker({position:e,title:t,icon:o,map:c})),j=h.length-1,i&&i.addMarker(h[j]),!1!==n){n=n||m.points[j].windowContent;google.maps.event.addListener(h[j],"click",(r=j,function(){a.closeInfoWindows();var e=new google.maps.InfoWindow({content:n});e.open(c,h[r]),s[0]=e}))}return this},this.setAllMarkersMap=function(e){for(var t=h.length-1;0<=t;t--)h[t].setMap(e);return this},this.clearMarkers=function(){return this.setAllMarkersMap(null),this},this.deleteMarkers=function(){return this.clearMarkers(),h=[],this},this.showMarkers=function(){return c&&this.setAllMarkersMap(c),this},this.createOverlappingMarkerSpiderfier=function(){return c&&(i=new OverlappingMarkerSpiderfier(c,g)),this},this.getOMSOptions=function(){return g},this.drawPolyline=function(e,t,o){var n=[];t&&(m.routes[e]=jQuery.parseJSON(t));for(var r=jQuery.isEmptyObject(m)||jQuery.isEmptyObject(m.routes)||!m.routes[e]?0:Object.keys(m.routes[e]).length,a=0;a<r;a++)m.routes[e][a].lat&&m.routes[e][a].lng&&n.push(new google.maps.LatLng(parseFloat(m.routes[e][a].lat),parseFloat(m.routes[e][a].lng)));var i={path:n,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2};return o&&jQuery.extend(i,o),l[e]=new google.maps.Polyline(i),c&&l[e].setMap(c),this}}(window,document,jQuery),XIMA.api.openlayers=function(e,t,i,o){var s={},l=[],p=function(o){var n=this;this.map=new ol.Map({target:o.target}),this.addLayer=function(e){n.map.addLayer(e)},this.initialize=function(){if(o.hasOwnProperty("baseLayerUrl")){var e=new ol.layer.Tile({source:new ol.source.XYZ({attributions:[new ol.Attribution({html:o.attribution||""})],tilePixelRatio:2,url:o.baseLayerUrl}),name:"baseLayer",title:"Base Layer"});n.map.addLayer(e)}if(o.hasOwnProperty("view")){jQuery.extend(o.view,{center:ol.proj.transform([o.view.lon,o.view.lat],"EPSG:4326","EPSG:3857"),zoom:o.view.zoom||7});var t=new ol.View(o.view);n.map.setView(t)}},this.initialize()};return{createMaps:function(e,t,o,n,r){var a;return a={baseLayerUrl:o,view:n,attribution:r},i((s={wrapper:e,map:t}).wrapper).each(function(){i(s.map,i(this)).each(function(){l.push(new p({target:i(this).get(0),baseLayerUrl:a.baseLayerUrl,view:a.view,attribution:a.attribution}))})}),l}}}(window,document,jQuery),XIMA.api.responsiveImages=function(e,t,i,o){var n={};function r(){i(n.wrapper).each(function(){var a={width:i(this).width()};i(n.image,i(this)).each(function(){var e=i(this),t=e.data("srcset").split(","),o=[];for(var n in t)t[n]&&o.push({src:/(?:.(?!\d+w))+/.exec(t[n])[0].trim(),width:/(\d+)(?:w)/.exec(t[n])[1]});for(var r in o.sort(function(e,t){return e.width-t.width}),o){if(o[r].width>=a.width){e.attr("src",o[r].src),e.attr("width",a.width);break}r===o.length-1&&(e.attr("src",o[r].src),e.attr("width",a.width))}})})}return e.onresize=r,{run:function(e,t){n={wrapper:e||"body",image:t||"img"},r()},refresh:function(){r()}}}(window,document,jQuery);